<?xml version="1.0" encoding="utf-8"?>

<application xmlns:config="http://www.top-logic.com/ns/config/6.0">
	<services>
		<config service-class="com.top_logic.basic.util.ResourcesModule">
			<instance>
				<bundles>
					<bundle name="tl-ai-openai.app-messages" />
				</bundles>
			</instance>
		</config>
		
		<config service-class="com.top_logic.knowledge.service.migration.MigrationService">
			<instance>
				<modules>
					<module name="tl-ai-openai" />
				</modules>
			</instance>
		</config>

		<config service-class="com.top_logic.basic.module.ModuleSystem">
			<instance>
				<modules>
					<!-- OpenAI Service for OpenAI API integration -->
					<module key="com.top_logic.ai.openai.OpenAIService$Module" value="true"/>
				</modules>
			</instance>
		</config>

		<config service-class="com.top_logic.ai.openai.OpenAIService">
			<instance class="com.top_logic.ai.openai.OpenAIService"
				default-model="gpt-4o"
			>
				<factories>
					<!-- OpenAI models factory -->
					<factory
						class="com.top_logic.ai.openai.providers.OpenAIChatModelFactory"
						models="gpt-4o, gpt-4o-mini, gpt-3.5-turbo"
						api-key="%OPENAI_API_KEY%"
						base-url="https://api.openai.com/v1"
						max-pool-size="10"
						max-idle-models="5"
					/>
					<!-- Anthropic Claude models factory -->
					<factory
						class="com.top_logic.ai.openai.providers.AnthropicChatModelFactory"
						models="claude-3-5-sonnet-20241022, claude-3-5-haiku-20241022, claude-3-opus-20240229"
						api-key="%ANTHROPIC_API_KEY%"
						base-url="https://api.anthropic.com/v1"
						max-pool-size="10"
						max-idle-models="5"
					/>
					<!-- Mistral AI models factory -->
					<factory
						class="com.top_logic.ai.openai.providers.MistralChatModelFactory"
						api-key="%MISTRAL_API_KEY%"
						base-url="https://api.mistral.ai/v1"
						max-pool-size="10"
						max-idle-models="5"
					/>
				</factories>
			</instance>
		</config>
	</services>

	<configs>
		<config config:interface="com.top_logic.basic.db.schema.setup.config.ApplicationTypes">
			<type-systems>
				<type-system name="Default">
					<declarations>
					</declarations>
				</type-system>
			</type-systems>
		</config>
	</configs>
</application>
